"use strict";(self.webpackChunkhandbook=self.webpackChunkhandbook||[]).push([[606],{4137:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),u=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=u(a),h=o,d=m["".concat(s,".").concat(h)]||m[h]||c[h]||i;return a?n.createElement(d,r(r({ref:t},p),{},{components:a})):n.createElement(d,r({ref:t},p))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=a.length,r=new Array(i);r[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var u=2;u<i;u++)r[u]=a[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},425:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(7294),o=a(6010);const i="tabItem_Ymn6";function r(e){let{children:t,hidden:a,className:r}=e;return n.createElement("div",{role:"tabpanel",className:(0,o.Z)(i,r),hidden:a},t)}},4259:(e,t,a)=>{a.d(t,{Z:()=>h});var n=a(7462),o=a(7294),i=a(6010),r=a(1048),l=a(3609),s=a(1943),u=a(2957);const p="tabList__CuJ",c="tabItem_LNqP";function m(e){var t;const{lazy:a,block:r,defaultValue:m,values:h,groupId:d,className:b}=e,f=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=h??f.map((e=>{let{props:{value:t,label:a,attributes:n}}=e;return{value:t,label:a,attributes:n}})),y=(0,l.l)(k,((e,t)=>e.value===t.value));if(y.length>0)throw new Error(`Docusaurus error: Duplicate values "${y.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const g=null===m?m:m??(null==(t=f.find((e=>e.props.default)))?void 0:t.props.value)??f[0].props.value;if(null!==g&&!k.some((e=>e.value===g)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${g}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:N}=(0,s.U)(),[w,E]=(0,o.useState)(g),T=[],{blockElementScrollPositionUntilNextRender:O}=(0,u.o5)();if(null!=d){const e=v[d];null!=e&&e!==w&&k.some((t=>t.value===e))&&E(e)}const B=e=>{const t=e.currentTarget,a=T.indexOf(t),n=k[a].value;n!==w&&(O(t),E(n),null!=d&&N(d,String(n)))},A=e=>{var t;let a=null;switch(e.key){case"ArrowRight":{const t=T.indexOf(e.currentTarget)+1;a=T[t]??T[0];break}case"ArrowLeft":{const t=T.indexOf(e.currentTarget)-1;a=T[t]??T[T.length-1];break}}null==(t=a)||t.focus()};return o.createElement("div",{className:(0,i.Z)("tabs-container",p)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":r},b)},k.map((e=>{let{value:t,label:a,attributes:r}=e;return o.createElement("li",(0,n.Z)({role:"tab",tabIndex:w===t?0:-1,"aria-selected":w===t,key:t,ref:e=>T.push(e),onKeyDown:A,onFocus:B,onClick:B},r,{className:(0,i.Z)("tabs__item",c,null==r?void 0:r.className,{"tabs__item--active":w===t})}),a??t)}))),a?(0,o.cloneElement)(f.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},f.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==w})))))}function h(e){const t=(0,r.Z)();return o.createElement(m,(0,n.Z)({key:String(t)},e))}},3055:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>u,toc:()=>c});var n=a(7462),o=(a(7294),a(4137)),i=a(4259),r=a(425);const l={id:"bamboo",title:"Bamboo"},s=void 0,u={unversionedId:"specification/data-types/bamboo",id:"specification/data-types/bamboo",title:"Bamboo",description:"- requirements in this section refer only to how p2panda specifies use of bamboo.",source:"@site/docs/specification/data-types/bamboo.md",sourceDirName:"specification/data-types",slug:"/specification/data-types/bamboo",permalink:"/handbook/specification/data-types/bamboo",draft:!1,tags:[],version:"current",frontMatter:{id:"bamboo",title:"Bamboo"},sidebar:"specification",previous:{title:"Encoding",permalink:"/handbook/specification/encoding-data"},next:{title:"Key Pairs",permalink:"/handbook/specification/data-types/key-pairs"}},p={},c=[{value:"Hashing",id:"hashing",level:3},{value:"Encoding",id:"encoding",level:3},{value:"Authors",id:"authors",level:3},{value:"Logs",id:"logs",level:3},{value:"Entries",id:"entries",level:3},{value:"End of log flag",id:"end-of-log-flag",level:3}],m={toc:c};function h(e){let{components:t,...a}=e;return(0,o.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"requirements in this section refer only to how p2panda specifies use of bamboo.")),(0,o.kt)("admonition",{title:"Requirement BA1",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"p2panda uses ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/bamboo-rs/bamboo-ed25519-yasmf"},"Bamboo")," with Ed25519 (Digital Signature Algorithm) and YASMF (Multihash) to encode and secure data.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"p2panda is built on top of ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/bamboo-rs/bamboo-ed25519-yasmf"},"Bamboo"),".",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"This handbook doesn't repeat everything that's in the Bamboo spec, so it might be helpful to have a look at that (it's not too long)."))),(0,o.kt)("li",{parentName:"ul"},"Bamboo is an append-only log data type that ensures security and authenticity of arbitrary data in order to share it in a decentralized and trustless setting.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Bamboo organises data by ",(0,o.kt)("em",{parentName:"li"},"author"),"."),(0,o.kt)("li",{parentName:"ul"},"Every author can have many ",(0,o.kt)("a",{parentName:"li",href:"#logs"},(0,o.kt)("em",{parentName:"a"},"logs")),", each of which contains many ",(0,o.kt)("em",{parentName:"li"},"entries"),"."),(0,o.kt)("li",{parentName:"ul"},"Entries contain p2panda data that we want to publish."))),(0,o.kt)("li",{parentName:"ul"},"The following sections explain how these concepts from bamboo are used in p2panda.")),(0,o.kt)(i.Z,{groupId:"entries",mdxType:"Tabs"},(0,o.kt)(r.Z,{value:"rust",label:"Rust",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-rust"},"pub struct Entry {\n  /// PublicKey of this entry.\n  pub public_key: PublicKey,\n\n  /// Used log for this entry.\n  pub log_id: LogId,\n\n  /// Sequence number of this entry.\n  pub seq_num: SeqNum,\n\n  /// Hash of skiplink Bamboo entry.\n  pub skiplink: Option<Hash>,\n\n  /// Hash of previous Bamboo entry.\n  pub backlink: Option<Hash>,\n\n  /// Byte size of payload.\n  pub payload_size: u64,\n\n  /// Hash of payload.\n  pub payload_hash: Hash,\n\n  /// Ed25519 signature of entry.\n  pub signature: Signature,\n}\n"))),(0,o.kt)(r.Z,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"type Entry = {\n  // Public key of the entry author\n  publicKey: string;\n\n  // Log id of entry, starting at 0\n  logId: bigint;\n\n  // Sequence number of entry, starting at 1\n  seqNum: bigint;\n\n  // Skiplink hash\n  skiplink?: string;\n\n  // Backlink hash, omitted when first entry in log\n  backlink?: string;\n\n  // Size of the payload in bytes\n  payloadSize: bigint;\n\n  // Hash of the payload\n  payloadHash: string;\n\n  // Ed25519 signature\n  signature: string;\n};\n")))),(0,o.kt)("h3",{id:"hashing"},"Hashing"),(0,o.kt)("admonition",{title:"Requirement BA2",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/bamboo-rs/yasmf-hash"},"_","Yet Another Smol Multi-Hash (YASMF)")," MUST be used to produce hashes for Bamboo entries and payloads.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The original Bamboo requires ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/AljoschaMeyer/yamf-hash"},(0,o.kt)("em",{parentName:"a"},"YAMF-hashes"))," to verify the integrity of entries and logs.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"YAMF is a multiformat hash that only adds new hashing algorithms when previous ones have been discovered to be broken."))),(0,o.kt)("li",{parentName:"ul"},"However, p2panda uses bamboo with ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/bamboo-rs/yasmf-hash"},(0,o.kt)("em",{parentName:"a"},"YASMF"),"-hashes"),".",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"YASMF has the additional requirement that hashing algorithms should be chosen that produce shorter hashes (256 bits)."),(0,o.kt)("li",{parentName:"ul"},"At the time of writing, YASMF only contains the BLAKE3 hash, which therefore is the hash function used throughout p2panda. It is fast, safe, and produces hashes that are just 32 bytes long.")))),(0,o.kt)("h3",{id:"encoding"},"Encoding"),(0,o.kt)("admonition",{title:"Requirement BA3",type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Bamboo entries MUST be encoded using hexadecimal encoding when being transported through the Client API via GraphQL.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"p2panda uses hex-encoding to make it nicer for humans to look at the data.")),(0,o.kt)("h3",{id:"authors"},"Authors"),(0,o.kt)("admonition",{title:"Definition: Author",type:"info"},(0,o.kt)("p",{parentName:"admonition"},"A p2panda author is a human or bot who publishes data using p2panda. Authors may have more than one key pair.")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Data published using Bamboo always belongs to the public key that signed it, this key is called ",(0,o.kt)("em",{parentName:"li"},"author")," in Bamboo."),(0,o.kt)("li",{parentName:"ul"},"People and bots who use p2panda can have access to more than one key pair, which is why we don't call public keys ",(0,o.kt)("em",{parentName:"li"},"author"),", as Bamboo does, we call them ",(0,o.kt)("em",{parentName:"li"},"public key"),".",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Data in p2panda belongs to the ",(0,o.kt)("em",{parentName:"li"},"key pair")," that signed it."),(0,o.kt)("li",{parentName:"ul"},"p2panda uses Ed25519 as the Bamboo signature scheme."),(0,o.kt)("li",{parentName:"ul"},"p2panda users may have more than one key because every device and client uses an additional key."))),(0,o.kt)("li",{parentName:"ul"},"Have a look at the ",(0,o.kt)("a",{parentName:"li",href:"/specification/data-types/key-pairs"},"key pairs")," section of this handbook for more detailed information on this topic.")),(0,o.kt)("h3",{id:"logs"},"Logs"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"When a key pair publishes data it is assigned to a Bamboo ",(0,o.kt)("em",{parentName:"li"},"log"),", which is identified by an integer number.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Every key pair has 2^64 logs available to them."))),(0,o.kt)("li",{parentName:"ul"},"In p2panda every Bamboo log is used to collect a key pair's contributions to one ",(0,o.kt)("a",{parentName:"li",href:"/specification/data-types/documents"},"document"),"."),(0,o.kt)("li",{parentName:"ul"},"Every log contains up to 2^64 - 1 entries.")),(0,o.kt)("h3",{id:"entries"},"Entries"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"p2panda uses Bamboo entries to record changes of data while giving us cool features like partial replication, cryptographic integrity and authenticity.",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Every atomic change is recorded inside an entry."),(0,o.kt)("li",{parentName:"ul"},"We call these changes ",(0,o.kt)("em",{parentName:"li"},"operations"),"."))),(0,o.kt)("li",{parentName:"ul"},"Have a look at the ",(0,o.kt)("a",{parentName:"li",href:"/specification/data-types/operations"},"operations")," section of this handbook for more detailled information on this topic.")),(0,o.kt)("h3",{id:"end-of-log-flag"},"End of log flag"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Currently p2panda doesn't reserve a special use for the end of log flag. This may change in future versions.")))}h.isMDXComponent=!0}}]);